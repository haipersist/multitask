# 1、高性能系统要求

&#x20;    我们每天使用的微信、抖音、淘宝、京东等应用，每时每刻都有较高的访问量，全站QPS、TPS都达到一个很高的水平。因此这些系统对于高性能都具有较高的标准。如何在高流量的情况下，仍然能为用户能够快速、优质的体验是每一个系统开发人员都非常重视的一点。

&#x20;    提高应用性能的手段有很多种，可以从不同的角度，包括缓存、横向扩展、纵向扩展、分布式等等。

&#x20; &#x20;

&#x20;缓存

&#x20;     缓存可以说是无处不在的，整个TCP/IP协议栈，任何一层都会涉及到缓存，计算机内部也存在各种缓存。比较常见的就是CPU的高速缓存，L1，L2，L3等等，高速缓存的存在是为了减少CPU的处理速度和IO之间的不匹配问题；还有在我们开发系统时会设置更多的缓存，包括客户端缓存、CDN缓存、进程内缓存、磁盘缓存、分布式缓存等等。通过缓存，既减少对应用的访问，又可以提高访问性能。当然，缓存也会存在一定潜在的风险点，最重要的就是缓存的一致性。如何能够保证当服务器对资源进行改动时，缓存的数据可以保证一致性。目前有很多种解决方案，比如Cache-Aside，感兴趣的可以观看《亿级流量架构》，本书对此不过多介绍。

&#x20;

扩展

&#x20;     除了缓存就是横向扩展。横向扩展简单来说，就是加机器，通常在电商大促的时候都会额外的加机器，加大量的机器。通过将整个系统的流量分散到不同的机器上，从而减少单个机器的负载。这种粗暴加机器是构建了我们服务的集群，集群上层可以通过不同的方式来实现负载均衡，通过http访问的可以使用nginx做负载均衡；通过RPC的，可以通过RPC框架来实现负载均衡，比如dubbo。当然，在网络层也可以实现负载均衡，比如LVS，nginx等等。

&#x20;

分布式

&#x20;      上面说的横向扩展是集群的部署模式，另外还有分布式的方式。分布式是一种革命，其一改之前的单体应用，将整个应用按照某种策略，比如DDD的思想，划分出多个小的微服务，不同的微服务构成了一个完整的应用系统。目前这种模式也是众多系统均采用的模式。比如电商系统，会划分出交易系统、商品系统、履约系统、客服系统、结算系统等等多个体量更小的系统，这些系统通过RPC或者HTTP的方式进行通信。分布式和集群是两种模式，但并不是互斥的，而是相辅相成的，整个系统是分布式的，但每个服务仍然会以集群的模式去部署。不过分布式在提升性能的同时，也会带来其他的问题，比如一致性。比较常见的就是在电商系统中，商品库存服务和订单服务，如何保证一致性，是一个很重要的问题。如果有深入了解的，可能会知道我们有TCC，消息表，TA啊等等处理方法。比较著名的就是阿里的Seata分布式事务。此外，分布式一个比较重要的概念就是CAP以及在实际应用中衍生出的BASEL理论等等。这里就不再赘述了。

&#x20;

纵向扩展

&#x20;     纵向扩展和横向扩展一样必不可少，机器规模不仅要大，每台机器的性能也同样重要。

&#x20;     纵向扩展简单说就是提升我们单台机器的处理性能。比如增加CPU核数，提高内存容量，使用SSD磁盘、提升带宽等等。

&#x20;

多任务处理

&#x20;     好，到了我们的重头戏，就是多任务处理。上面提到了纵向扩展，即硬件配置上来了，但是如果程序写得太垃圾，无法充分利用计算机资源，火车跑得快，全靠车头带，软件的能力至关重要。多任务处理的本质就是追求更高的处理速度，从而在整体上提高单台机器的处理性能。
